# Check out https://docs.codemagic.io/yaml/building-a-react-native-app/ for more information
# Please review and update values

workflows:
  react-native-android:
    name: React Native Android
    max_build_duration: 60
    instance_type: mac_mini
    environment:
      vars:
        CM_KEYSTORE: Encrypted(Z0FBQUFBQmdOMlJTSXZQMkNxbkNhX3VPWWROT0k1ckpNUE1SSlM0clBRN3B0UXhPcUVNUUtULWhmQWJreFZzV0JpVXpuVF9KakpWbWhUV3RNdTFVeXp3cFNhRnZHc2xyS3AtNHJLXzZaT1VjbldBNEZpWlhySzdwVUlPaWZkWU5xYk91ZUR5UWNTem5qdmdMM3RTY19TOGk5V1dtcDc0cUZsM0RnR3c3b3czSEFPeXR1Mjd0QXpWb1RMbVQ4cnlKYXFfQWNxa080c0dncElickQ5Z2U1WVl6VmRRQUpSZ1pYd0t0VmZ4TWo1SkJ2RWIxcTFINmxRR3VlOEN3M0VqUTJwanJaYWVINnNjY0NWMjl0allmZm9SMU9HRS1ERVRQSnh2MFB5ODFlcmVBTzU3OVJ0T3Z4NnZDMVN1TWNkZW5xS2EyWWRMZW4tMWdTRUZyeW81WWFybnFSR0NvU3Uxbm5qLXBOQnZlSG95YW5tZFBjbGVGbUpSVl84Nm5tTXY3TzdHeV93SW9Halhpc0ZXMWRPdDNwdWkyVDJWaEZ2R2NnRmh6STJrWHhUNmJYUGMtWUFSS1ZTRkhfTzl3T1dSbksxTWtaY2dtd2dTaDNBckE0TVhTUDNla3A5a2NpZmNSN3lRdDQ2dF9haU9HQWJWU3dQcXI4UXNxT3ZCZE94OVR4cGFqbFdRRXktWWNXX1YtZGZNSk9tYXhWcVE2aFBDSUUyeVFsLWd0c0t5dGNkalU5blhuRDVJcDJLdzdqeld2RDRjR3ZvUGtyZGRWN1d1aWtTWm9MYmlOdHFnLTdGVTRRQnl3Y3lvNVAwSVRKUzk3YWpiajVhTDJ4S1hWeVNYNXAtbmF2OVVwQldoTE5HZXR1RXBqVUFSQWdvVWRXRGg1bE9oNXJmSDZacS1qbGN6YzNyN0czSFVQTC1TOXVBVlhhdG44RW82dEZDdExKREFEd2lmWTNRcldhcUpGMF9jLTg1bjNzTVpNdWZieHFnQUNRRFhGVWJXNmVMSXpXeHRlN2VxVWJIc2wwcFozTmREeHR6YmtoOHkxeHlyRHVXQWRlVU96QXVicHpkRFY4OGdJX0dLVktTZXNWYUIzUWlWNmhzSHlOQUdCaHh1V2ExTjc4YmdDeHl2Q0M5U3RBSUxxMzRHbnVVQjVzMDNwRzZXLXFlak9PUlVkbEFibEU5TVlscnZCaHZVWGFrQmRNWmtzbFJxa3FhbG53bWpGSGtPOFE4cVMzcXN0Nmk3QnZYNV9tOEtsbkRudUx1dWpYd3ZneGMxZE1Dek5BVjRDamJfNE5DMXdSZF9WU2JlQ3QtWHJIazBCMllSWHVWMkRxQUl1SW91aExYNkxpaFRUcU5aMmpNM0JxQjhaaS1DNmRqZjY5YW9TZmdEa0VzZUZtdngxalloWmN3MWZRTE0wbzh5WG1SX2pYbXcxbVVHMko2SWVzdWxpd2NDdWtDWF9TTjlTR3dKYTZOSFdfLVZ4ckhNWG92emFBdTZIaVhmWlI3TENiajl4SGU2Zk5rN05ld1JSUnVoYkhJMllCTl9HeE1jeXl6VXhyYmlSdDBCSFZHR2dxdTU0a1hvWVZZRWg4blFmWWhLa2w3dWthXzFHQXRvWGxaNllNaTVGSk1XSFpnMThaSHVFRkZKMWVpXzVrQzJnV09OWkZhR1FaeExnVE95SFNUalE3alp2NjUxRTQzZ25Md0tVYi1hQVhWSXd2X3NhMk5EQkFwMWlBQmN0dEhIZDlqZnV4TVRWb3ZYUWt2am1CbnlxaXRYLXQwd0ZVRzhLMEhvTXNPZGtMNmkycmVvSC1LTDk0VHpfRURBa1BTcGMzZ0hKOXhjTUNCdmtBY0NySzk3OGx3WkdZYWZfeW5WLWRadWRLVEhlTWs1VHRtTnhiYjhMZGw4cTB2NGtPcm9rSHNCQ0RzRXVENlZDUlFubERDZlkwaUZCckplTFJ0UC03dmRfT2F3VjRpbTVHY3NINEdodzhMMzNNamc2TnFoRWpwcjRoTnpFU1lodEhZQmZtRE80eV9jbTY0YkpqUEFNZVFPQ1Qxc3czZjlhbXE5QjhjTXFiUXZRNHZCa0tnS3pHRS1zb1MwMjRCRF9Yd1VzdjR0RENWUnNmQnZXb19EMEVqNjhQNkxhV3RyajVqdDJkRWN1dXg2UmNINkc3RDBVWDloWV96MEpreC15aU9uMUdReUJvcDd0OS1oc1UxRGUwd01UdHV5X2hzT282amoydnNEbzlFdHowalgtU0wyMDB2YzBGdUJ0YjFvaExhNVF5Zk9Ib2RUSUxXTFpWUUVsREhhMm9rbkZYRDFFNy1waFg2amNMMF9CWk9PRDBWUm40SDJObXUyNnZLOWlDZFlOYk1IV3BwWUxvTGxpSk5hVmNfV2t0bnZYVkh6aWlhU2psdHZ1d1piRXdXMEJfampJSzVvQXZJREdGVW9OWmtnQTNIVUxUUlh6bGxkMjZNTjc5Mk5ReUVpeTNUNGZJS3k2Vm01bHZ3RWZDZnVtcDRNUU9Jb3hTcEU1S3p6dTJENVNWSmlUZzBtcWVUWGYyWG5ZMFIzYVhMUEc0TWE5d1JmdjJFTlhJSnpnTm9yZENDR0p5bGNLZERkcGdtUGpORDN2TnhTSTVuT0VZekE3cUdRalFJem5VOXRCZnVKTndNenNzS3JLQWNRbXlTN1A2eDd2T0lFRHFkcTdpSjRGOGRBUmdQSFBmOWNva0dVWnIyUHZndGtxYWx5TGpOSFVEaGZEeWZwMDFSMm5YLVZWTTZqdElUekNIWWdqY0FfYThUZFRIWExpTzdrdnlaUFJqYUY0d1h0WTd0V0YwTFgxb2tYMWh3UklncHFENEJBSjNKalEyMjJnNGhJWU9rSjdMVklQZU93emZkOFIwUjBFTllfMnJpYlVrMzd2aWVDOU9vb01yenpVLU9TdXRTNHpxNXg4c2g0d19IWkZldjJwcUp3QnEtcm5tRE02QnU2U2EyVHJtcE5lWXNNeGFjZnllWUZDRVA0UmVzY1YyYjlNWDFrQkpjZ3NtSzVjOVRueHNvbDRYTW1NMkRPQ0tTSndqVjVMNDl4dzJYMjl4Q25sUFpEcnhUcXhKZUd0NmI0R0tnbkFRMnd1RHRONU9DUks4Qm15WmRicUtPU01IY0RwV3JUSy1JcEZRa1ZfbEJSUWVwS3dGblJyODlibUFlX1RhVUcwaWlEM2dMRjdSdHV5UFRNOUNwSE5vYUFMakJhR05qZ2I5RVFmbkhtQW9FblBQWXZqQ2JRa0I3RlNqenlXNlBkRXo2dkJVRXFiUGJaWl9nZVRQa2VxZnZBUl9rdDN4ME9kUUhRNDJmMTBHWVJGQXY2RDRMRlpzV1dMQk10NkNxQjFkQlBaNTNOb2sxajBlalVjZ2xzVTBFUE9pd2VPd2NBT0FaWjU2bnhCWTNMWGNTN0txZmp4M3lxY2J1QktKV1loWXFSV3V0a25IcHJ1NDBIR1o5ZXNpTDJBZ3VzN0RtLTNBcFBrRi1HcENRNGYtcFF6MnF4UFZWTXgyMnRtcnVXNDQxbmR2NlFtSnF1UzRzbEpRYTZ1aWRxODM5MGExOENxbGZiZHVZck02YXhXdVBXMDhrNzhZdHFiSzQ2RmlmMUZDMy13SmU3LXhDVEJEcnhiam1Uelg4TTdpbzltd3lVRnJkWHJqZjE1Z2M3VU9DbGZMRXVSbUJQMWc2bGRqUEpGelVJRno1Q0k0MmJrTlNKUTByX2lERUVnYkNQMkZpYnV1ZEluQWtUV3NhaEQ4MHBrSXRoY3lTRFUzUmppZWZCVUkxcjBlVzF3cTlvTnRiVVVzUlJ4d0NmbndaaFZPa094WkFWb3o2dnE2bTZmeXFZcnhXNUgybE12VWI2a0hvZ0dyTUlja1lBbXdxNDBpbTNDQ09DUGlRczBXX3A0MzFfNE9VblAycE52RVFkQmtkYjQzMU94X25ROXY3LWxWZE45Snp6TV9ZZlRoWFNaV2xYMzE5TTJ1VjNRUFQybWQ3cHFONGxPbzV5dzg1cnZ4TGNTRWdHeWdkZ0d1Q3pDWFAzcDQ1V3NIbzVIN19VYWZQSGNYSTdjME9jYzZIM1NrT0s3ZmFGZzdjcVBOWFp0NFpvSGV6YWw2SWxPMkREb1IyeGhWVTlqOGVkYW5SSjBDZ0htMGlVWS1Gb2tPdmIxNTVxR3BWUWpwekxDWmphN1FydTdRS3JWdHRfbHU4MWpIYXk4VkY0VEdqZmdUeGhuU1B1dWFZaDZWX2M3dzN2RWU2clRRZjBGWEJncDRWOGlvY0E2cFFaVVY0U0I3V3Q0RFpLUE1fTGl5YXJ5RjlpNWJhUWo2OXB3SE8xc2piYXVpRTljU2VlSzY5NnhGcXY3S0lCT3JDaER5N2JnTHl3Um5zalAtZ0ZpQ21fdjBvelljR0gzQlJUd0ZzVm9ndXc2UGIwOGJvS05VSEFWdEJKcW5jLXFrcFlObXp5QktZcHpfTjdsX3IyUWNVZG1wS3VUSzBXVmxKWWRONTdLZURlS3dFRXlGTnE3WC1oY2V6UThBUGNpQkM4WjBSY21ZdFMtRVNBRzdZV0ZqdFY5d1hjcEtPQnBIajFXLTdoVmlvb0VCd1czcXgwYWxTN0diMTRITWVURVVKcU96eW9yVnNtejY1a1k3dkJHWU1uMV9GS05Da1I3NjlnLU9ydzNDdFRFeWpLNndQNWxqYkhUS3JmRy0xOFdIdHNERk9UTUg5bHNTdWVJaFl3UjA3TmpLQnlXOER5MkU5aGEtUmVyamJmSGN2RGlEYmxYMmdLRjJxUmoycjU0bk1SNlVsM2ZWb1BaN044SHlIV3pVVFhCcjJLcGZjSGxhYkNlc2tNT2NmZnZFNy1qQTVuYW41Q0RHMklvcDJHY3VXdml2WkdWU3JDVlJzWk1Hem91VTZPd3RXUE1oaThId25Kc2EzZ2RsbUh1a0FZNDBDY0MxX2lFang0Mll3RGMweWVvZUw5WVRPRllWYUpnWFpSb0dvd1hHYzljWUR2VDVuLW1HOGNhdDBiMmtjWlBlYjB1bnZZMlNqNlBvUXF3NktHOEtoM0Y0OFRBRE5acVdhd0FsLWdSb0R4bXNwSlplb2llb29xdURvdHZVWXg4ekpWZ0xVM3JHS2k5LXpmZTFseGpVWWhNdVlObmFKVlNkYmlRSDhrUmZ3YlZOcUZ3X1hTd2VDX3JlcGhBbjNNSWF6YkdBVi1mV3Q1UzBoX29maU80b2RkOUVnRnh5NXBOQy01YVI3MjBjSjFsbjBnMkdLZGZyc0RjWW53eU9hcUVQR0pWWDZhQ1FLd3o4ZUZqUDVRa2hOLXNnblhzMFV1NXBNYlVFOGhEYXhNMEdQVWRIR19yZGRSR3FjSzAyNDNBal9mYWdBYTI5enk0bWp5SDQ2bVNZRmVVTTdaTjgtLXROcXVIektBejYxS0kzLXRQYkktSzg0cz0=) # <-- Put your encrypted keystore file here
        CM_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmdOMlJpcDVrSmJzUm8wNEE2TGdXb2Vka19SckZ4YnlIVnhqMmlFRk9wY1AzLUh2X2lpNGFwVzh1RDF4TTRDVDhMQmlNMHg0VGdwR0JMV2paaEVTNUM4NmFfX0E9PQ==) # <-- Put your encrypted keystore password here
        CM_KEY_ALIAS_PASSWORD: Encrypted(Z0FBQUFBQmdOMlRvem8tcmRrbUcwRlpLamtDYWY3Y1ZuM1VOVGpRLTFCTlNzeDlXX1NfUG9LakV5QndrWkFmajlub3lpSlNHbmVxLU0wY0NycVl3WUY1S0QtRVdweHozMmc9PQ==) # <-- Put your encrypted keystore alias password here
        CM_KEY_ALIAS_USERNAME: Encrypted(Z0FBQUFBQmdOMlNucG5pTERkaVJVWHN3cnJSR3lidlU5SGlibmlEanAzYXdLWjVESXRKbWZrV3ZRZWs1Mm16NVdTUVgxSzlsS1pmbGpPVF9YelRJSXNwLW9OdVFiTHBPWXc9PQ==) # <-- Put your encrypted keystore alias username here
      node: latest
    # triggering:
    #   events:
    #     - push
    #     - tag
    #     - pull_request
    #   branch_patterns:
    #     - pattern: develop
    #       include: true
    #       source: true
    scripts:
      - name: Install npm dependencies
        script: |
          npm install
      - name: Set Android SDK location
        script: |
          echo "sdk.dir=$HOME/programs/android-sdk-macosx" > "$FCI_BUILD_DIR/android/local.properties"
      - name: Set up keystore
        script: |
          echo $CM_KEYSTORE | base64 --decode > /tmp/keystore.keystore
          cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
          storePassword=$CM_KEYSTORE_PASSWORD
          keyPassword=$CM_KEY_ALIAS_PASSWORD
          keyAlias=$CM_KEY_ALIAS_USERNAME
          storeFile=/tmp/keystore.keystore
          EOF
      - name: Build Android release
        script: |
          # build Android
          cd android
          ./gradlew assembleRelease
    artifacts:
      - android/app/build/outputs/**/*.apk
    publishing:
      # See the following link for details about email publishing - https://docs.codemagic.io/publishing-yaml/distribution/#email
      email:
        recipients:
          - micah.price@cortexlogic.com
        notify:
          success: true # To not receive a notification when a build succeeds
          failure: false # To not receive a notification when a build fails
      google_play:
        # See the following link for information regarding publishing to Google Play - https://docs.codemagic.io/publishing-yaml/distribution/#google-play
        credentials: Encrypted(Z0FBQUFBQmdOMjZDYXU0bVNYMUNyUWdzVy1EQlBjX0ZUaFdtdWRDZ2t0VjlGald0X2tBUVdtNGtLS3IzQVdGWHlja3NwTmxsQU03V1VXV0pqNTloclZ1R2QzNlFyRUUyQkVldE1RYldNV2xDeVpoTWF0Mm5aRjVqOW4xMDVIb2N4NV9SdTAwdXRqUEZlYlZNWVF2YjVXR25RWlNtQkN3NWo2cS1TWXdKTkIycVRDR01Od1p3Ym9ubWVwSnJtanloMDA1TFZweVhIb19PQzdET29sZC1vaWMwbG90bmhqU0hKcV91LUpBekRuYUlOVExjaE1SVTJlZEtmXzZCdHgxQ1JmSTA0WGxFUElUUVpYWDlIOGxuNm9aMUpDTWZyWDlYcXU1aWVwXzBXSUNvRFl2RmFGV25ERHhZLWM1dDVQZzhVbFQtM045UVFfeWRScnVsVW9YbEFGdzhvTlAtRWs5Y2t0V0huV2NRZVNTRk1rUGQwTUhIcy1ld2w3OGtNcDZzclRDZlFVOVNUUkxSU3h1bUFxU0lMSFY0MzVxQWt1amNoNzliR2FmNlNuRkVLY2l2UFNfU2JZV2JRUmN5T2dzUnJ5QUxLZkdnZHBlVGR0Y1NLRmgtclYxSkg2bHR3R1hkWGJXRm1EdjdVWVBXalFCZEZYbWYxdlM0RFVLb0JQRGFqdlJaYS1feS1GbHlMdVIwUHBObkpsdnhncGRyNWMxNzZ6MHVEUkRXT3dKRmU2dV9jRWJvS0RYYUo5a1hkcm5oNTNEcjIzc3BTOUtHQU83SEIxblVnTjdsZElQVmNLb2xQTXhyZWFncGlkLWJDYVpDS1JXeUlpM3l0M1ZlVTFhSGpiaWMyRlR4cjNZeVZVaXVRYWxEVGhEMjUzazR0RHVOZDVfZ080cW5DSjlaVVRHY2FIMDh0eGFDbm9CQ1ljVmk1VElMTW15MWN1ZDZHWTdVUVV5Z0xWQWFFaDgxc1BiRUtqbGh5LTVMUWhYWE11Vm4tX3JVaWNKOUViN0Z4VC1DQVhaVmtnUWZQbnF5MUYyYjB6Zjd1TktqaHhURHp2NXNGUHh6cGVTS3hzaFVURFVIRG5zQ0h3T2ljUS1rQUlZLVdnRFZlOU9BSVJDT2F3aF9RaWtMdl9QbllaakE0UXZRWThiY0YyV1ByN2JVeU0ydUF4VGNMcklyY1N2NTZBTF9EMHhLOU13d3R1TUNucDRROE1XR3pOVDg0TmkxMVlTNWtSNklaNDFWWng0ZkotTEpodTkxTDNUTXg1bmRpYW8yaWhUQ25UWFZaVXJKeEZhcU1xbDFRdGxwQXJ2dm5nb3lheDlESk5sU08wdGhpaEpmeG5BcEtVUHNjVUhJaWZrWjRha2k4TlkzQ21Ec3EzcFhfaFRxUEh6TW1CQ0FmZHYxc3FPYnpBb0pqRGlSX2JJXzg1aEVOVFVSOGVkd2xTWjJfMHFpdENybWdjLVRaTjNKOG1XVy1yVHY0Y3VlQXBsb2lMR0U3bW01d2l0T1BNc3JWVFlzWlQ2bjhVbzZnT2FrQ0pfaDBCeU0wdWZEU28wN2R6SlFGdXhFTlFRQXVGNnRMVGlsYTR6cFNsRFlTSFVyR2dROXVqejNoUFR6czJUUi1kMVR0Q3NFR0Z0eG44ZXpXRXl4V2RZU0FQQVRMdjF6X3JhVmRmZ0tNRjlLVzZkZWZTSVE5cEswNGl2QUg5cDk3d21qNHp0eVQ4cmZmTTg0OWc4bHEzaTg2Y2xyaThwY1FTczk5NjE3aDc3b0x3dVQ0Q1JzQno5eFFRM3ZUcHdrUkxiXzZDUWUySUg1ZGhOTy1VUlpRMTZwUlg0cmhvem5RQnRJcVBfVTZMaGFOa1NBamNMMXlsRTJqZTZnZTR0WFZwc0J4Q1dWNm9fRHBrN3NxcHNVQTFRZ0FHTWlMQndQNUhPa1FJUnFpRHhRUzhlQXhsS2lNT1FLdGFTUUFTRDA4eXBPZ3VicFNSZFlYak9vdGxEVk5IUTNTdURnU09UYXV3RU9YUURrRFQ1SWtiWGM0M0hjeC0zeWVDUWtLSWJKcm5fd2VGbkNzM05kTkc4d0JUTWFUUnI0WnZWcm1aY2lkX3N3RENkblBQaXFiVkxJNDE3eEhhRW5HVVVkWVFIUG5lSU1ONUVWXzc0aXBmeExBTkg0RWJRMm83aDFfcnpxVTJyN2JrbWZNaWZtU2tvVUhzOEw2VkY5RXpzaVI0cjlNLU1yRm1WVGNUN1A5aDBDbDFvaE1HX2VqaE9nbTl1TkprLTBOZFR4cjZLaU0wRkJ0QTJMYmhhaHRZbHdONkJlSlFnYWVvNXBkSkNra3UtYzlXOGdzTGRBLUlWa0ljbVNfSEQ4Zm9uVWphLUtrNWpoNVptM2JCd3JjNEhEaUtkTjVoWUVkbG1YSEN1SUM3OU9OU3F6OWMyOGliSWlzLUJiQ2ViNnBfODNVdkVfRmY3a3MxX0sydkNLZGNrZDFTZG42T3U5OVBTdkFtVEd2MVlzdl9BeEZQRUR3UzFLZmtHOU5jWlk3WTVUY2RSbE52RXNvbGQzNzhVclVOYzRhak91SXFpSHZQYUxqb1NHSXJMY1pnMFZ0bC1sZE1yTG5mRzFzcmM1M3c5VFU5czFZQ0VCbzBmQzRmZXlaYUpiZ2Nub1BHVS1panVaZk5aSU1NNHBvNG1CbXlWMTMzdVdyVjN5a2pLTlRJaDR2Y1NZc0tlSXkzOVc2ZjVNeGYweVR1Z0ZMZG1qSlR1VnlGVVBfNjJBTTZpal85czUwT3BKUnJOc2hodUNTWkFaMGZ3RnVSUjhWWF9QRlZYZXJmQzBjQTROaWZkUXBBa0NacllScHowS1NIeW9rTnZSbkNnbnlsMFhGX1BGZ3U4UVpKdnRTM0xmMzhIUmxwS1BLMkxlcFBGLTJaS3IxSGd0RmxLamxwSGU3XzZHNGRlemFtb1Z1N25tTGxfc19MYWhHV0JLb3ZGeFNIYVk5TnlXT2M2VENPWXlpc0JKWHpuLWxoVXBDd2ZpTFQ1ODVsN0pqYmRIRUZXSmZCQk9kRjdKdVBiUXVEREJYYmVxQUEtVUZHa0tqcVkyenRlZWMtYnkxNnJUeXVHa2kxazRHUHJod2ZTSmt6a2FoT0VhV21GcW9QY3FYUzZKdTYxaHktQy1mV21ENGx0SXl5MHprTFFtbDdfV2ZyNUFfd1pmQXM2ZzV4X0FPVTdhUUVIci0zSDhSMVpIM2h1YnkyQTZKdGhTN0FpcGZLOVpNa0hzWFFwNnhFNVFsTTNWQXRJeEU0MWJfMzZCNHNycHZQam1QNnpYZWx0MXhnWlBoYVI4Nm9JZi1mcFNITXZzc1VjMWR4NmlSeTc4aU1Wd0R2MGg4bUF1WWptdW9YeVgyNno3bHpyb1NzZ0JLdndJdFVYUnNvdFhYV3VGcEJ1Vm1FYXk0RjZObkstN2NRemNfOXVyLU9EdFh6aTVqSzBMR3FSeGpoQWpnc2I5RFFHeXlkdWVMZVFqcU92MTRxUTBnVkJGaUVFZHVFejBscnZ6UWJkbU5OeENHRVUzWHdTZlVBS3dvRE9PNzFSTmlCWFdmNTNYM1pscl9iNWc0VHZPZEx4QXQzdTBIUHNBQ0NOZmctc0NkTnBpMExMbk1BMzdhR3I0R1hvM3B5UVpwVjFUaW5USzVhVlZtSElocG1hY1NiWVBOS0lmNVFGUnR5QlpnUFREdkJocFBzNzQ2Mnk0Y1hUcnZ4ZmdIdmdIZ2x5aVNnTkxmeGZtMVNqZTlQZ2tia3l3RXA1RExzMjNQXzEtbHpOUWNTOFVPZmhmekZtUVNsdllwM2ViUHp3UG5DRVhXTGZZa00wandGRlVwSC16R3dHSWNKWkZKN1I4NzhfU1NhQld3aHpUSjJSSnBTNGRuN3gxZVcwalpfMDJmcnZDWUcyZGlUcXdXbkJTZWVQOHg0MG1OemdTaEpmLUlmdlhLbGU1NncwU1R3a3Rtb1dxT2FKd2l0T0ozalBydVY0YzIyZnF5blBqVFlhRzFnaDRBWVdzQ1M5SldKNERBWTBIV0tWQ1VmalhOc2dlLUM2S3ZvdWZybHNRR2RDRkdJTjlubEN3OXpKQmFQdHJWUkN3bEZHNDFzYjJfSXNsUnVmcjNkRG5Ta3pCVk1NNU1jaWtkZzEteG9wMjBvdUJIbU11MzFCbDlhNnE1RzdERGNZOEoxejczTDh2OHRvMW9RaXR4ZHBpS1BoYWtIRHVqcndIRjNlVG1nYlZTc05SYURFWTFlYWJqN3poRjhQQUlaRXBfV185STJsdldETVJuTzQ3THMtVnlNZlBKXzVWVjJxQ09YOVY4bUhRUUN1eTZHVHJ6cTJqZnZuWEMyWmk2V2xiY3BaU0MyN29pQzh2Z1dnUjhDNDFxYTZCN1FaZDJvMUFfUVVvcFpvTWdNRGJFTTZhTVlJSzBqdFJiSmIzUGlnZzU2VXFYZTJhUjFBYVpFekJOMHZuVmlBRnk3R08zTWNVZXJtQzhBY0lhSVVvcjZZbDdzbkczc3hyQlZmLTR2eWp0aS15aWdxODltaVRoblVlazM4VHFtZHV3TXdPdDJnMkJuZ2U5ZXlNZEhQTFIwOFBsVkRwdFlEWVNvMTR5VHlWZ1hMTnNsQ2JmSzcyb2xFMUVfTEZkTy1uZHFYQnp0SnhYMEZwc0pnc1FwTzhkZTZEem5WYk4wbXZrYVNnTkF0ZzNzNWZ2WlBGZnp0WHN1VVlyUWFSa2lsVTJfRjFDMlRDaUVqSWdTXzhmSm03S3ZFZHRNUjJDZ0hMYXBXLUFWQnZqYUxLVURfdlB4UjNHUk9FX1E1eDZjQmZlUEN2N05DR3hoZjZJOHJvaTI1TUJDUTdEVlluNVlkY3JDOXZCTGtzTzBNaVBYSlJTSGJtXzF4Wk9ISFg2OS1zdS1EYnFRb0V4X0tmRExORlI0MG1Qck5KOGlranY4Q1YxOXdXM1M5b0NPSk9IdkpuUlY1NDlLUXY2VGZDem84dGItdkttZk1tVFRvQnRoRXFqWk1BMm5xempISVVwQU4wOHZwSUhZOVByNXBZQ1g5OVNVNDZLS2xNSWhVZXk3aHZBZnlGelJveFJwU3ZFV0pyTnBZVjJGQXFUVkd5Sm5YYm56WGNvbHBKdDVyYU05WmFwOGJDaVJLN20zNS1HRmJCZUNoRXZJajFJWUZCeThleVBFclhwU2ViNXVuclh5cHFSVndyMVRnSDM3ZGJTVHRWVm9EUGYtTE9DMW1VX3dXQVFBbVQ3OGVCMzBoa29pb2ZBT05hV0RTZDRHc0JEVVpqejdaeUhmdHFNTXJraXNWQVhiamZVYktETjVQeVMxRjNpcFdLamZ0NGxHckIyOTB2amZ0VEc1V1lvRWdwcksxeWtwYWZ3NXYyc3BRallZWEFxTERjNndESmI4QkhJc25OZWZrbFBpSWlibnBoalVhLVM0djgybzBwQXpjc2Z0cFRlVkNzblRWaTZFRnV0cjVlMnQ5SktaT2VXUHZUUlk0ak1NRnd5M3VQeHc1UzkwWlpmUWppQlEyOEI1dERueHlaQVZsMlpXWFlHVUVQMENtV2ZDNV9SdnEtRkVhemVCbUxEeXd1MzRQamRLWjhLSS0xMnh5OWR6Q0ZsUERXLWN4c2RaeUpEVXllNzEzcGl5UGdHSUdSZ0UtZE81c01zQmVvdzladGRQazlRYzZEVXI4dmdneXZvcmwyRlVSc3pyOD0=) # <-- Put your encrypted google-services.json here
        track: internal
  ios:
    name: iOS build
    max_build_duration: 15
    instance_type: mac_mini
    environment:
      vars:
        XCODE_WORKSPACE: 'KmSample.xcworkspace'
        XCODE_SCHEME: 'KmSample'

        APP_STORE_CONNECT_ISSUER_ID: Encrypted(Z0FBQUFBQmdQSjE5TndjMFRUMFpMQjRmWTlzWWVUSFNtZkNZRkZZRl9CYTlzZ2psR0d1SlhvQ19vUWJVOC00a3ZhRy1DTG13d2RyZFYtcGM1dG9Salp2SktuSHMxZUJCUGc9PQ==)
        APP_STORE_CONNECT_KEY_IDENTIFIER: Encrypted(Z0FBQUFBQmdQSjJVck82NW9LNFg4NFpiVUhOYmU2YXV2U2U4bGRQTGtXcEx1MXg1ZWI4R1lEdmx4d2tnNV8wYlBnOG5OeW1kZ1ZMX0lac1gzMnl0eWZoSDlac1RvdFp2cWU3X2o2VEtLa3hUMWNTMTJsUVBmckZFdFBDR0Jkcm51NDZJNmI0bl9uZnQ=)
        APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdQSjI1ZG9jQXNiZ2p5RUpxa2huV3dWNFpVX0p4T050b2J2UDE0M25zWjlWTnR6d3l5OG9pS3dkeV9FNFIxcVgyOHB4TEwtM0VjTkp0RDBSSnVRRVRtUjZGdGo1SnpGTFd1TnE4RGNLZWY2eWY0UVNwdGVIdVFjVzJid25Kd3VBcGMyU1N2ZlVxVzdXZ3paWTREVjlTNmZicUp4WXk4S1Y3ajRQTDhZQWRma2FCeWs4RlNwX2hfUldlVUxSLUhCbmNuZ21xcUs4Q0hWaFZQRURKaFgyVEUxbDh0dkU3Z0tlazhGVGNjVEVmbFQtTTVKMXJQODFJeGZpemtBdDI4ZFpDT0hPVHl0X25JWU1jVk9EOUo4Zm1FVTc4eDRDSkV2OUJHdlh4bnpxSzh2VGhyYi1DM3VoN2JPZldBWFUzbVc5bXR3MFI3T3E2LS1tOTBVNUFNQ1ZPamI0eC1jNHdqTHl3c1U4ZVVrbHluYURHM3NkbVVrWE5YT3JkS0xNMy1qSHE1ejlpcVFvbVc0dmVhMmJKazJ1RXRCM3FyU3FDdXJ5YmN0ZVE0cFM4eG5lUEpHM05CdUc0NDYzUFo2VG1jNTFiOVphVWh3a3VGYkxGak0ycVpuV25EYmlfWGotcVVpVnJKSUlGVkk0a29yX0ZkSjdzbnRweVctcVdYOG9MTjhNbnJwMzdOcmJVd1ZfNXBWQjFjbUZQcmZGX3hnPT0=)
        CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdQSjRndVJqNUpOenFxTW5hZmppUzdZTFMtLWJ4RjVfXzNfS0RlRThHSU5ZWlBSUXlwOE9JOFNCT1h6QjlFaXFjN1JPVGFUYkRTUGlITy1MTmdrekVlWms1YURxbFdHcXpGTG5vQ0psSklJNWhoeHhhbHd2RTlnZVRvTnlzbXZhWlZUYW1vaDlrZ3dOM1FQUkVLVUozQ1oxRGFjRmg4UEFEUEpzSTJLLTN3bFBFMmRlUXc4Qm5IdFlLU01OYmNzNHdDTWhHMEpfQUJzd3NBLXFRb1FaendMZGJHQjZ6QjNobWZMTzdoT293a2RCYjRmYnpoMjBNdVFkTTRPSks5Ymd4Vk1uT1ZGUzUwMFI3UkxRdEUtS3pTUUVmZzNEejNXWEdmOW52WHRacnZkejIyaXJfYUR0bkNpVnV0NWhORkE3VXY2clNHU2gyR00wdmFQSFcyNGtMenFBZGlnb1VtVUNYSTUxU2R3LUdsaVktbTlMWjFEMVJ6MV8tWncwc0tIak5ObWxtUk96bWRuWlVaRkJqdy1fX21CNEk4QkwzNWdnVTRMeDJsaVJ1SlNsb3gzYm1JbG93RzBhTTBZaTcwYWs2WTJleDhxSkJNdVZKVy1uck45RG9HaXZRUnJkNHR4T0NnZFBJOWZlMnRrQk1HM3dVdjlrNjNvT1p3RHJxbGtvN1dyeW51ejItQU5wT3FlU05Ec3N6Ymg5aDViZXhydVdGQkozU2hET3lfb2E1dGl6RmtqT0hoQk1Pdi0weGh4bkVQd0JMZUowNnc2RnU3alJ6a0E3b3N3WnBvdFBiOXoyN0ZlbFkyeGRCVk5ETDlrXzN6VXJQajhIOXZoMjJFbUNFZkhIOVFPRGlhV1k1QlVyaU1RbHJaOXZkQ0dPNVdUYmdtSVA4enRTWmRzRnB4VDlxWUl2TXctR29hSDRvU3BpQUhEQ21YYVdsYnU0ODZxWTRsamh0cy1KMUNHbGI4TjhIeXl3N0RJcHloZHV3LUg0cm5DWTZKcVdpa09SOElNbUx2blM2SmpXNmtPbWl0LVFjRHl4dmR4dzY4SHJuekJvVzUwWk1XV1ozcWExOWYtUzZXcUZ0YVFyd0lXYWtQMEIxb3FfalV3cEgtbXU3aGtQY0VVbXhQems2U21LQXhmQU9OSTUxbFRzdWpCM0JRSTAxZThMR2dPQWpNRHprQUpYLWVYUDh5V0w4ZlhMYm10bW1mWC00MlJYelF3QzJOQkZGVi0yMl9hb1d4bmhZb2k3ZFV0YkpoXzJoWXNfQklKenNVelFVNVZXOG5WQUF1SXphdGJwQVZ6bTJZYTdxa2RYT1IwTDZBRk1BMWtjUkdiMmxRQU5DLXFBWUlvTktYNTYxU1RYYVlEYUhkYTQydkZkRjd5aVJPR2RQY2xJNFNxMmF5ZHhfNGdOaHlsTmhzRmNpZW9FZDVqb2lJdXRjdm5LcHV1MkFiU0lnV1FNY2pPbUpPRU1yZW85S2RldFc5NTNyTU00MktKSXoxekdLaTJnRU5kT3VtVTJhczhfQ3dIbmxzb3ZHUWVDeXEzejZMMmQ3c25fSE55b0h5ZmtCNlAwN281ajFWSWJqQXQ0M2M4YWJvNjZoU1BPMHZVM01ubm14dGJnZmoxNVplR3hma2ZXcHhPdWg0eThOWlRDUXc4QlJXOW9zY3lrUkFOaXBqMWJsZl9OX1BqVks0ZzBtaHBpOFZ4VDlRaEJhVGtOMnBHakNMNVVPS1UtWnFqOUpveFp3dmd2ZTUza1UwR3RsSDVJMGF6cnV3dVBPbEpHLWpweUtNTGdDLU9HMDhLWlo5Zm4tQlBMR2c2T3l4NHE0TWE4YmhjVUJ3ajRxZUFvQWNiZE9rWDc0REtoWkNSMjhhcGdoaFp4dWtXdEM2SlRlOXpQTExFX3V2RjFiQW01cWk4MmJ6RHV4Nl9od2JEZnZYbGNnNzN3S24tM2hUcDFCMVJEZEF0WW1yZUlRWXdzNHRickxvYVJwV3VUNnRFLXdmQXp3OVpKeVN3M01id1pCel8tN2NoQlFoQzFyTDdBNFpfS2VIR1ViX2IwaUNTdVlfX0I2eEpyRWZlZkc2VTEzMTlnZ3duUXpsMExjTF8yY0RyVkp2R2JGZ1FwWHRpWk43cUpHc1Fua0R4czdTelM3S1RrU3NzU3l6THRRLWh4ODMzSWhoVkZsVTZVVFJXdk5QZjEyak8yTkhVRXpXbXl3V1FzaVFxUHhMRV9aUHJTSVdsWEZoOEZYa05rbDQwS3dOd1g4ejdNUjllMDdpZFRCcVBiQ0xZSGs3TnVxLWNRTFlNM0wwWW44Q3cxZzEwdUY2bUpfYXJ4SmRoM0xJcU9na2pPTkI5b0NWZnRoS3hRdzBSY1ZWd2huU1BhcWwwWlJNcm91clA1QUtHNUo3aHBWNUl0UEU4SU9tcHFrQWI5Sjlwc2RLb29UekJrNkhKRGs5V2xDSHowZ1ZyMUhVdW1wSnlXZklnbXZtajlybG4tZm1KcWs0aHRKVGZEazJVRU8wSGNXTWdMWmJRTlNjTFFQQUJuTW1scU5jNDc4cGo5UzBsTS15cG1OeVI0WmZoSW5JZTU0ajVraWREcjh5TkV3TVNkV3I0MnY2bFV2a3l5N0cyUUV3b0YyMlZ4anRiOFUwUFhfRUhPRjdLOGFkYjktamJIa1VFUHEtYUNlVFIwTkZKeEl4ZW1uT3hDWmtpSWRONnB2ZHhSd1dyWFA0dlEzSWJ3a2QxR1hEblZwUzRlRDl0T2ZuZE5XR3hWWHVNQUpUSUNmVmtVUnRmMW9naWI0Yi02b0ZTcFV1VWY5aTdIWUd3di1CWEN0Tkw0OVhfUnhRbURIako1OHdvcFJEZG5yZTk1ejJCS0VpbFRmVEdlRTlYQ0dacUNDbFQzbEJ6NWV2X1M3UDRLTmp3aE05bEk0LTFpSEJQTnpZdlp0QWF6U1lpcE9aYlRtTFQ3cjJGNWl6eTRla05yLVp0RndEOVJ2RFUwcnc4WnN1TVU4SzVxd2JBbVpDUHd4cUpMVEh2dTg2Y0RtaEJUZzU1ZG55SjNIX3ZkZGxlcERESXVqS3Zha1gzUl9FWjJnR2hGODJCdmhfLXI2Ql9hWHo1MmF0dVJITE82Zjd6Wm9CWVNzSm01dmFKc1lrY19vZURrYXpJUVB0aUpLempwTUNRRXc0b1o1Qmt0RVlnbGlzZU5vel9objZXVWJ5Z3UwdEdoWW1SYlduYzdrZ1JCbUI4X3F5bDNsRml4MmNaUzJTOVNKQlE0bjBsNkVOZDdVMmpSQllFc2NCLWJuemlhTUFvNUFwNmpQNDFkc1pWQ3BTMnh3UkhJOHVHVGYyUzByLWM0enl5ODQxTjREc1hoM3NDZ3ItQ3VzOEJJdmRYamJ5OEFzcm5Pelc3aGRwX3ZNelB3eHhZcHZhYjR2UEJ3VWxROUFUMDRHeV96VXh3TjBJbS1wNFdObUNYQzdBVnpPdlBwdHpsS3l6QUlidzdjb0x5cVVNTjVsSWE3SnR5T0VmSkN3dWp5U1IzZGp2TGhWQkNsT05DZG9yNzlHdTk4dHJQcFFrc1hQRTgxNktUZ3RHT1VvUW5HU1U3ZkJBS0tZbS1rVWw3TmNlVHJ3eUE1U3MxQUZTMmc4VG5wYi1weEc2YWtUVW1DQUpqcmJjdS1FQ29WYlh6OS14ajFuS1ZEUjhLSFZNcldORWlOUEdVRWdLRnkwT2hNeWJ3S3EzbEtsMTNmSzlVNWFha3g1WEtWTnRySjFtbllOcTRJTVNEelpKbTZkSjFNVkNFbGFiN2FUeTd3T2RidWhWa2ZEcjNoclZzWVVyNDNGN2pFVzNkMG5ZTm1nVy0xbUY0azdlam1aTzRrdmNHNmlyM3lxa3RBMHA3SEdBRXI1RHQwSG5SbzExWWd4dDNnclJSUU5LRFFyRkFzVmd6cnB1bWNpYlRDNFJhY3AwMG1ycHE0U09Nb1FySjNvdVN1RTFBQURiS1QwMGxFeGVLQ1U3ZlhWZzF0dFV4eXJhQ1ZlYjIxZE5PSVQ5UzU1Z1NPZjlnTm1zSXQ5bWY4Q2MzODJORU53Q05ucG1MeTIwMnVqbVZNPQ==)
      node: latest
      xcode: latest
      cocoapods: default
    triggering:
      events:
        - push
      branch_patterns:
        - pattern: master
          include: true
          source: true
    scripts:
      - name: Install npm dependencies
        script: |
          npm install  --legacy-peer-deps && gem install cocoapods-user-defined-build-types
      - name: Install CocoaPods dependencies
        script: |
          cd ios && pod install
      - name: Set up keychain to be used for codesigning using Codemagic CLI 'keychain' command
        script: |
          keychain initialize
      - name:
        script: |
          # For information about Codemagic CLI commands visit: https://github.com/codemagic-ci-cd/cli-tools/blob/master/docs/app-store-connect/README.md
          # For details about the --type paramater below - https://github.com/codemagic-ci-cd/cli-tools/blob/master/docs/app-store-connect/fetch-signing-files.md#--typeios_app_adhoc--ios_app_development--ios_app_inhouse--ios_app_store--mac_app_development--mac_app_direct--mac_app_store--mac_catalyst_app_development--mac_catalyst_app_direct--mac_catalyst_app_store--tvos_app_adhoc--tvos_app_development--tvos_app_inhouse--tvos_app_store
          # echo $APP_STORE_CONNECT_PRIVATE_KEY | base64 --decode > ../../key.p8
          # export APP_STORE_CONNECT_PRIVATE_KEY="@file:key.p8"
          app-store-connect fetch-signing-files "com.amble43.test" --type IOS_APP_ADHOC --create
      - name: Use system default keychain
        script: |
          keychain add-certificates
      - name: Increment build number
        script: |
          #!/bin/sh
          set -e
          set -x
          cd $FCI_BUILD_DIR/ios
          agvtool new-version -all $(($BUILD_NUMBER + 1))
      - name: Set up code signing settings on Xcode project
        script: |
          xcode-project use-profiles
      - name: Build ipa for distribution
        script: |
          xcode-project build-ipa --workspace "$FCI_BUILD_DIR/ios/$XCODE_WORKSPACE" --scheme "$XCODE_SCHEME"
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.app
      - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.dSYM
    publishing:
      email:
        recipients:
          - micah.price@cortexlogic.com
        notify:
          success: true
          failure: false
      app_store_connect:
        apple_id: Encrypted(Z0FBQUFBQmdQSl9nRnladFhTYjVkcWVTcXJZTGhoclZwRWdZRFBoVGJvVmtXSjZmdW1PYUhnRmVvMURxUjZjNmNVdU5pekh5MC1MUTZ2TmxTcFlLeWNCcEl2MTJWanlwaTlRSlYzUC1WOWljdVBGRWxRUXlRc2c9)
        password: Encrypted(Z0FBQUFBQmdQSl9DM0FES01ZR1FHc09sanA0dXNtX3pScHRiY1NBNzVrLUh1c2xRSXRhbHF3MUxhWklTSGdKNTQtQWxWdmRTTTAzaWFVZDF1M3F4b1NOR0RHN1VVNEh5eFVkODZkc1pLY3B5RTdMSlc0NTRoMGs9)
