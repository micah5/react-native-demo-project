# Check out https://docs.codemagic.io/yaml/building-a-react-native-app/ for more information
# Please review and update values

workflows:
  react-native-android:
    name: React Native Android
    max_build_duration: 60
    instance_type: mac_mini
    environment:
      vars:
        CM_KEYSTORE: Encrypted(Z0FBQUFBQmdOMlJTSXZQMkNxbkNhX3VPWWROT0k1ckpNUE1SSlM0clBRN3B0UXhPcUVNUUtULWhmQWJreFZzV0JpVXpuVF9KakpWbWhUV3RNdTFVeXp3cFNhRnZHc2xyS3AtNHJLXzZaT1VjbldBNEZpWlhySzdwVUlPaWZkWU5xYk91ZUR5UWNTem5qdmdMM3RTY19TOGk5V1dtcDc0cUZsM0RnR3c3b3czSEFPeXR1Mjd0QXpWb1RMbVQ4cnlKYXFfQWNxa080c0dncElickQ5Z2U1WVl6VmRRQUpSZ1pYd0t0VmZ4TWo1SkJ2RWIxcTFINmxRR3VlOEN3M0VqUTJwanJaYWVINnNjY0NWMjl0allmZm9SMU9HRS1ERVRQSnh2MFB5ODFlcmVBTzU3OVJ0T3Z4NnZDMVN1TWNkZW5xS2EyWWRMZW4tMWdTRUZyeW81WWFybnFSR0NvU3Uxbm5qLXBOQnZlSG95YW5tZFBjbGVGbUpSVl84Nm5tTXY3TzdHeV93SW9Halhpc0ZXMWRPdDNwdWkyVDJWaEZ2R2NnRmh6STJrWHhUNmJYUGMtWUFSS1ZTRkhfTzl3T1dSbksxTWtaY2dtd2dTaDNBckE0TVhTUDNla3A5a2NpZmNSN3lRdDQ2dF9haU9HQWJWU3dQcXI4UXNxT3ZCZE94OVR4cGFqbFdRRXktWWNXX1YtZGZNSk9tYXhWcVE2aFBDSUUyeVFsLWd0c0t5dGNkalU5blhuRDVJcDJLdzdqeld2RDRjR3ZvUGtyZGRWN1d1aWtTWm9MYmlOdHFnLTdGVTRRQnl3Y3lvNVAwSVRKUzk3YWpiajVhTDJ4S1hWeVNYNXAtbmF2OVVwQldoTE5HZXR1RXBqVUFSQWdvVWRXRGg1bE9oNXJmSDZacS1qbGN6YzNyN0czSFVQTC1TOXVBVlhhdG44RW82dEZDdExKREFEd2lmWTNRcldhcUpGMF9jLTg1bjNzTVpNdWZieHFnQUNRRFhGVWJXNmVMSXpXeHRlN2VxVWJIc2wwcFozTmREeHR6YmtoOHkxeHlyRHVXQWRlVU96QXVicHpkRFY4OGdJX0dLVktTZXNWYUIzUWlWNmhzSHlOQUdCaHh1V2ExTjc4YmdDeHl2Q0M5U3RBSUxxMzRHbnVVQjVzMDNwRzZXLXFlak9PUlVkbEFibEU5TVlscnZCaHZVWGFrQmRNWmtzbFJxa3FhbG53bWpGSGtPOFE4cVMzcXN0Nmk3QnZYNV9tOEtsbkRudUx1dWpYd3ZneGMxZE1Dek5BVjRDamJfNE5DMXdSZF9WU2JlQ3QtWHJIazBCMllSWHVWMkRxQUl1SW91aExYNkxpaFRUcU5aMmpNM0JxQjhaaS1DNmRqZjY5YW9TZmdEa0VzZUZtdngxalloWmN3MWZRTE0wbzh5WG1SX2pYbXcxbVVHMko2SWVzdWxpd2NDdWtDWF9TTjlTR3dKYTZOSFdfLVZ4ckhNWG92emFBdTZIaVhmWlI3TENiajl4SGU2Zk5rN05ld1JSUnVoYkhJMllCTl9HeE1jeXl6VXhyYmlSdDBCSFZHR2dxdTU0a1hvWVZZRWg4blFmWWhLa2w3dWthXzFHQXRvWGxaNllNaTVGSk1XSFpnMThaSHVFRkZKMWVpXzVrQzJnV09OWkZhR1FaeExnVE95SFNUalE3alp2NjUxRTQzZ25Md0tVYi1hQVhWSXd2X3NhMk5EQkFwMWlBQmN0dEhIZDlqZnV4TVRWb3ZYUWt2am1CbnlxaXRYLXQwd0ZVRzhLMEhvTXNPZGtMNmkycmVvSC1LTDk0VHpfRURBa1BTcGMzZ0hKOXhjTUNCdmtBY0NySzk3OGx3WkdZYWZfeW5WLWRadWRLVEhlTWs1VHRtTnhiYjhMZGw4cTB2NGtPcm9rSHNCQ0RzRXVENlZDUlFubERDZlkwaUZCckplTFJ0UC03dmRfT2F3VjRpbTVHY3NINEdodzhMMzNNamc2TnFoRWpwcjRoTnpFU1lodEhZQmZtRE80eV9jbTY0YkpqUEFNZVFPQ1Qxc3czZjlhbXE5QjhjTXFiUXZRNHZCa0tnS3pHRS1zb1MwMjRCRF9Yd1VzdjR0RENWUnNmQnZXb19EMEVqNjhQNkxhV3RyajVqdDJkRWN1dXg2UmNINkc3RDBVWDloWV96MEpreC15aU9uMUdReUJvcDd0OS1oc1UxRGUwd01UdHV5X2hzT282amoydnNEbzlFdHowalgtU0wyMDB2YzBGdUJ0YjFvaExhNVF5Zk9Ib2RUSUxXTFpWUUVsREhhMm9rbkZYRDFFNy1waFg2amNMMF9CWk9PRDBWUm40SDJObXUyNnZLOWlDZFlOYk1IV3BwWUxvTGxpSk5hVmNfV2t0bnZYVkh6aWlhU2psdHZ1d1piRXdXMEJfampJSzVvQXZJREdGVW9OWmtnQTNIVUxUUlh6bGxkMjZNTjc5Mk5ReUVpeTNUNGZJS3k2Vm01bHZ3RWZDZnVtcDRNUU9Jb3hTcEU1S3p6dTJENVNWSmlUZzBtcWVUWGYyWG5ZMFIzYVhMUEc0TWE5d1JmdjJFTlhJSnpnTm9yZENDR0p5bGNLZERkcGdtUGpORDN2TnhTSTVuT0VZekE3cUdRalFJem5VOXRCZnVKTndNenNzS3JLQWNRbXlTN1A2eDd2T0lFRHFkcTdpSjRGOGRBUmdQSFBmOWNva0dVWnIyUHZndGtxYWx5TGpOSFVEaGZEeWZwMDFSMm5YLVZWTTZqdElUekNIWWdqY0FfYThUZFRIWExpTzdrdnlaUFJqYUY0d1h0WTd0V0YwTFgxb2tYMWh3UklncHFENEJBSjNKalEyMjJnNGhJWU9rSjdMVklQZU93emZkOFIwUjBFTllfMnJpYlVrMzd2aWVDOU9vb01yenpVLU9TdXRTNHpxNXg4c2g0d19IWkZldjJwcUp3QnEtcm5tRE02QnU2U2EyVHJtcE5lWXNNeGFjZnllWUZDRVA0UmVzY1YyYjlNWDFrQkpjZ3NtSzVjOVRueHNvbDRYTW1NMkRPQ0tTSndqVjVMNDl4dzJYMjl4Q25sUFpEcnhUcXhKZUd0NmI0R0tnbkFRMnd1RHRONU9DUks4Qm15WmRicUtPU01IY0RwV3JUSy1JcEZRa1ZfbEJSUWVwS3dGblJyODlibUFlX1RhVUcwaWlEM2dMRjdSdHV5UFRNOUNwSE5vYUFMakJhR05qZ2I5RVFmbkhtQW9FblBQWXZqQ2JRa0I3RlNqenlXNlBkRXo2dkJVRXFiUGJaWl9nZVRQa2VxZnZBUl9rdDN4ME9kUUhRNDJmMTBHWVJGQXY2RDRMRlpzV1dMQk10NkNxQjFkQlBaNTNOb2sxajBlalVjZ2xzVTBFUE9pd2VPd2NBT0FaWjU2bnhCWTNMWGNTN0txZmp4M3lxY2J1QktKV1loWXFSV3V0a25IcHJ1NDBIR1o5ZXNpTDJBZ3VzN0RtLTNBcFBrRi1HcENRNGYtcFF6MnF4UFZWTXgyMnRtcnVXNDQxbmR2NlFtSnF1UzRzbEpRYTZ1aWRxODM5MGExOENxbGZiZHVZck02YXhXdVBXMDhrNzhZdHFiSzQ2RmlmMUZDMy13SmU3LXhDVEJEcnhiam1Uelg4TTdpbzltd3lVRnJkWHJqZjE1Z2M3VU9DbGZMRXVSbUJQMWc2bGRqUEpGelVJRno1Q0k0MmJrTlNKUTByX2lERUVnYkNQMkZpYnV1ZEluQWtUV3NhaEQ4MHBrSXRoY3lTRFUzUmppZWZCVUkxcjBlVzF3cTlvTnRiVVVzUlJ4d0NmbndaaFZPa094WkFWb3o2dnE2bTZmeXFZcnhXNUgybE12VWI2a0hvZ0dyTUlja1lBbXdxNDBpbTNDQ09DUGlRczBXX3A0MzFfNE9VblAycE52RVFkQmtkYjQzMU94X25ROXY3LWxWZE45Snp6TV9ZZlRoWFNaV2xYMzE5TTJ1VjNRUFQybWQ3cHFONGxPbzV5dzg1cnZ4TGNTRWdHeWdkZ0d1Q3pDWFAzcDQ1V3NIbzVIN19VYWZQSGNYSTdjME9jYzZIM1NrT0s3ZmFGZzdjcVBOWFp0NFpvSGV6YWw2SWxPMkREb1IyeGhWVTlqOGVkYW5SSjBDZ0htMGlVWS1Gb2tPdmIxNTVxR3BWUWpwekxDWmphN1FydTdRS3JWdHRfbHU4MWpIYXk4VkY0VEdqZmdUeGhuU1B1dWFZaDZWX2M3dzN2RWU2clRRZjBGWEJncDRWOGlvY0E2cFFaVVY0U0I3V3Q0RFpLUE1fTGl5YXJ5RjlpNWJhUWo2OXB3SE8xc2piYXVpRTljU2VlSzY5NnhGcXY3S0lCT3JDaER5N2JnTHl3Um5zalAtZ0ZpQ21fdjBvelljR0gzQlJUd0ZzVm9ndXc2UGIwOGJvS05VSEFWdEJKcW5jLXFrcFlObXp5QktZcHpfTjdsX3IyUWNVZG1wS3VUSzBXVmxKWWRONTdLZURlS3dFRXlGTnE3WC1oY2V6UThBUGNpQkM4WjBSY21ZdFMtRVNBRzdZV0ZqdFY5d1hjcEtPQnBIajFXLTdoVmlvb0VCd1czcXgwYWxTN0diMTRITWVURVVKcU96eW9yVnNtejY1a1k3dkJHWU1uMV9GS05Da1I3NjlnLU9ydzNDdFRFeWpLNndQNWxqYkhUS3JmRy0xOFdIdHNERk9UTUg5bHNTdWVJaFl3UjA3TmpLQnlXOER5MkU5aGEtUmVyamJmSGN2RGlEYmxYMmdLRjJxUmoycjU0bk1SNlVsM2ZWb1BaN044SHlIV3pVVFhCcjJLcGZjSGxhYkNlc2tNT2NmZnZFNy1qQTVuYW41Q0RHMklvcDJHY3VXdml2WkdWU3JDVlJzWk1Hem91VTZPd3RXUE1oaThId25Kc2EzZ2RsbUh1a0FZNDBDY0MxX2lFang0Mll3RGMweWVvZUw5WVRPRllWYUpnWFpSb0dvd1hHYzljWUR2VDVuLW1HOGNhdDBiMmtjWlBlYjB1bnZZMlNqNlBvUXF3NktHOEtoM0Y0OFRBRE5acVdhd0FsLWdSb0R4bXNwSlplb2llb29xdURvdHZVWXg4ekpWZ0xVM3JHS2k5LXpmZTFseGpVWWhNdVlObmFKVlNkYmlRSDhrUmZ3YlZOcUZ3X1hTd2VDX3JlcGhBbjNNSWF6YkdBVi1mV3Q1UzBoX29maU80b2RkOUVnRnh5NXBOQy01YVI3MjBjSjFsbjBnMkdLZGZyc0RjWW53eU9hcUVQR0pWWDZhQ1FLd3o4ZUZqUDVRa2hOLXNnblhzMFV1NXBNYlVFOGhEYXhNMEdQVWRIR19yZGRSR3FjSzAyNDNBal9mYWdBYTI5enk0bWp5SDQ2bVNZRmVVTTdaTjgtLXROcXVIektBejYxS0kzLXRQYkktSzg0cz0=) # <-- Put your encrypted keystore file here
        CM_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmdOMlJpcDVrSmJzUm8wNEE2TGdXb2Vka19SckZ4YnlIVnhqMmlFRk9wY1AzLUh2X2lpNGFwVzh1RDF4TTRDVDhMQmlNMHg0VGdwR0JMV2paaEVTNUM4NmFfX0E9PQ==) # <-- Put your encrypted keystore password here
        CM_KEY_ALIAS_PASSWORD: Encrypted(Z0FBQUFBQmdOMlRvem8tcmRrbUcwRlpLamtDYWY3Y1ZuM1VOVGpRLTFCTlNzeDlXX1NfUG9LakV5QndrWkFmajlub3lpSlNHbmVxLU0wY0NycVl3WUY1S0QtRVdweHozMmc9PQ==) # <-- Put your encrypted keystore alias password here
        CM_KEY_ALIAS_USERNAME: Encrypted(Z0FBQUFBQmdOMlNucG5pTERkaVJVWHN3cnJSR3lidlU5SGlibmlEanAzYXdLWjVESXRKbWZrV3ZRZWs1Mm16NVdTUVgxSzlsS1pmbGpPVF9YelRJSXNwLW9OdVFiTHBPWXc9PQ==) # <-- Put your encrypted keystore alias username here
      node: latest
    # triggering:
    #   events:
    #     - push
    #     - tag
    #     - pull_request
    #   branch_patterns:
    #     - pattern: develop
    #       include: true
    #       source: true
    scripts:
      - name: Install npm dependencies
        script: |
          npm install
      - name: Set Android SDK location
        script: |
          echo "sdk.dir=$HOME/programs/android-sdk-macosx" > "$FCI_BUILD_DIR/android/local.properties"
      - name: Set up keystore
        script: |
          echo $CM_KEYSTORE | base64 --decode > /tmp/keystore.keystore
          cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
          storePassword=$CM_KEYSTORE_PASSWORD
          keyPassword=$CM_KEY_ALIAS_PASSWORD
          keyAlias=$CM_KEY_ALIAS_USERNAME
          storeFile=/tmp/keystore.keystore
          EOF
      - name: Build Android release
        script: |
          # build Android
          cd android
          ./gradlew assembleRelease
    artifacts:
      - android/app/build/outputs/**/*.apk
    publishing:
      # See the following link for details about email publishing - https://docs.codemagic.io/publishing-yaml/distribution/#email
      email:
        recipients:
          - micah.price@cortexlogic.com
        notify:
          success: true # To not receive a notification when a build succeeds
          failure: false # To not receive a notification when a build fails
      google_play:
        # See the following link for information regarding publishing to Google Play - https://docs.codemagic.io/publishing-yaml/distribution/#google-play
        credentials: Encrypted(Z0FBQUFBQmdOMjZDYXU0bVNYMUNyUWdzVy1EQlBjX0ZUaFdtdWRDZ2t0VjlGald0X2tBUVdtNGtLS3IzQVdGWHlja3NwTmxsQU03V1VXV0pqNTloclZ1R2QzNlFyRUUyQkVldE1RYldNV2xDeVpoTWF0Mm5aRjVqOW4xMDVIb2N4NV9SdTAwdXRqUEZlYlZNWVF2YjVXR25RWlNtQkN3NWo2cS1TWXdKTkIycVRDR01Od1p3Ym9ubWVwSnJtanloMDA1TFZweVhIb19PQzdET29sZC1vaWMwbG90bmhqU0hKcV91LUpBekRuYUlOVExjaE1SVTJlZEtmXzZCdHgxQ1JmSTA0WGxFUElUUVpYWDlIOGxuNm9aMUpDTWZyWDlYcXU1aWVwXzBXSUNvRFl2RmFGV25ERHhZLWM1dDVQZzhVbFQtM045UVFfeWRScnVsVW9YbEFGdzhvTlAtRWs5Y2t0V0huV2NRZVNTRk1rUGQwTUhIcy1ld2w3OGtNcDZzclRDZlFVOVNUUkxSU3h1bUFxU0lMSFY0MzVxQWt1amNoNzliR2FmNlNuRkVLY2l2UFNfU2JZV2JRUmN5T2dzUnJ5QUxLZkdnZHBlVGR0Y1NLRmgtclYxSkg2bHR3R1hkWGJXRm1EdjdVWVBXalFCZEZYbWYxdlM0RFVLb0JQRGFqdlJaYS1feS1GbHlMdVIwUHBObkpsdnhncGRyNWMxNzZ6MHVEUkRXT3dKRmU2dV9jRWJvS0RYYUo5a1hkcm5oNTNEcjIzc3BTOUtHQU83SEIxblVnTjdsZElQVmNLb2xQTXhyZWFncGlkLWJDYVpDS1JXeUlpM3l0M1ZlVTFhSGpiaWMyRlR4cjNZeVZVaXVRYWxEVGhEMjUzazR0RHVOZDVfZ080cW5DSjlaVVRHY2FIMDh0eGFDbm9CQ1ljVmk1VElMTW15MWN1ZDZHWTdVUVV5Z0xWQWFFaDgxc1BiRUtqbGh5LTVMUWhYWE11Vm4tX3JVaWNKOUViN0Z4VC1DQVhaVmtnUWZQbnF5MUYyYjB6Zjd1TktqaHhURHp2NXNGUHh6cGVTS3hzaFVURFVIRG5zQ0h3T2ljUS1rQUlZLVdnRFZlOU9BSVJDT2F3aF9RaWtMdl9QbllaakE0UXZRWThiY0YyV1ByN2JVeU0ydUF4VGNMcklyY1N2NTZBTF9EMHhLOU13d3R1TUNucDRROE1XR3pOVDg0TmkxMVlTNWtSNklaNDFWWng0ZkotTEpodTkxTDNUTXg1bmRpYW8yaWhUQ25UWFZaVXJKeEZhcU1xbDFRdGxwQXJ2dm5nb3lheDlESk5sU08wdGhpaEpmeG5BcEtVUHNjVUhJaWZrWjRha2k4TlkzQ21Ec3EzcFhfaFRxUEh6TW1CQ0FmZHYxc3FPYnpBb0pqRGlSX2JJXzg1aEVOVFVSOGVkd2xTWjJfMHFpdENybWdjLVRaTjNKOG1XVy1yVHY0Y3VlQXBsb2lMR0U3bW01d2l0T1BNc3JWVFlzWlQ2bjhVbzZnT2FrQ0pfaDBCeU0wdWZEU28wN2R6SlFGdXhFTlFRQXVGNnRMVGlsYTR6cFNsRFlTSFVyR2dROXVqejNoUFR6czJUUi1kMVR0Q3NFR0Z0eG44ZXpXRXl4V2RZU0FQQVRMdjF6X3JhVmRmZ0tNRjlLVzZkZWZTSVE5cEswNGl2QUg5cDk3d21qNHp0eVQ4cmZmTTg0OWc4bHEzaTg2Y2xyaThwY1FTczk5NjE3aDc3b0x3dVQ0Q1JzQno5eFFRM3ZUcHdrUkxiXzZDUWUySUg1ZGhOTy1VUlpRMTZwUlg0cmhvem5RQnRJcVBfVTZMaGFOa1NBamNMMXlsRTJqZTZnZTR0WFZwc0J4Q1dWNm9fRHBrN3NxcHNVQTFRZ0FHTWlMQndQNUhPa1FJUnFpRHhRUzhlQXhsS2lNT1FLdGFTUUFTRDA4eXBPZ3VicFNSZFlYak9vdGxEVk5IUTNTdURnU09UYXV3RU9YUURrRFQ1SWtiWGM0M0hjeC0zeWVDUWtLSWJKcm5fd2VGbkNzM05kTkc4d0JUTWFUUnI0WnZWcm1aY2lkX3N3RENkblBQaXFiVkxJNDE3eEhhRW5HVVVkWVFIUG5lSU1ONUVWXzc0aXBmeExBTkg0RWJRMm83aDFfcnpxVTJyN2JrbWZNaWZtU2tvVUhzOEw2VkY5RXpzaVI0cjlNLU1yRm1WVGNUN1A5aDBDbDFvaE1HX2VqaE9nbTl1TkprLTBOZFR4cjZLaU0wRkJ0QTJMYmhhaHRZbHdONkJlSlFnYWVvNXBkSkNra3UtYzlXOGdzTGRBLUlWa0ljbVNfSEQ4Zm9uVWphLUtrNWpoNVptM2JCd3JjNEhEaUtkTjVoWUVkbG1YSEN1SUM3OU9OU3F6OWMyOGliSWlzLUJiQ2ViNnBfODNVdkVfRmY3a3MxX0sydkNLZGNrZDFTZG42T3U5OVBTdkFtVEd2MVlzdl9BeEZQRUR3UzFLZmtHOU5jWlk3WTVUY2RSbE52RXNvbGQzNzhVclVOYzRhak91SXFpSHZQYUxqb1NHSXJMY1pnMFZ0bC1sZE1yTG5mRzFzcmM1M3c5VFU5czFZQ0VCbzBmQzRmZXlaYUpiZ2Nub1BHVS1panVaZk5aSU1NNHBvNG1CbXlWMTMzdVdyVjN5a2pLTlRJaDR2Y1NZc0tlSXkzOVc2ZjVNeGYweVR1Z0ZMZG1qSlR1VnlGVVBfNjJBTTZpal85czUwT3BKUnJOc2hodUNTWkFaMGZ3RnVSUjhWWF9QRlZYZXJmQzBjQTROaWZkUXBBa0NacllScHowS1NIeW9rTnZSbkNnbnlsMFhGX1BGZ3U4UVpKdnRTM0xmMzhIUmxwS1BLMkxlcFBGLTJaS3IxSGd0RmxLamxwSGU3XzZHNGRlemFtb1Z1N25tTGxfc19MYWhHV0JLb3ZGeFNIYVk5TnlXT2M2VENPWXlpc0JKWHpuLWxoVXBDd2ZpTFQ1ODVsN0pqYmRIRUZXSmZCQk9kRjdKdVBiUXVEREJYYmVxQUEtVUZHa0tqcVkyenRlZWMtYnkxNnJUeXVHa2kxazRHUHJod2ZTSmt6a2FoT0VhV21GcW9QY3FYUzZKdTYxaHktQy1mV21ENGx0SXl5MHprTFFtbDdfV2ZyNUFfd1pmQXM2ZzV4X0FPVTdhUUVIci0zSDhSMVpIM2h1YnkyQTZKdGhTN0FpcGZLOVpNa0hzWFFwNnhFNVFsTTNWQXRJeEU0MWJfMzZCNHNycHZQam1QNnpYZWx0MXhnWlBoYVI4Nm9JZi1mcFNITXZzc1VjMWR4NmlSeTc4aU1Wd0R2MGg4bUF1WWptdW9YeVgyNno3bHpyb1NzZ0JLdndJdFVYUnNvdFhYV3VGcEJ1Vm1FYXk0RjZObkstN2NRemNfOXVyLU9EdFh6aTVqSzBMR3FSeGpoQWpnc2I5RFFHeXlkdWVMZVFqcU92MTRxUTBnVkJGaUVFZHVFejBscnZ6UWJkbU5OeENHRVUzWHdTZlVBS3dvRE9PNzFSTmlCWFdmNTNYM1pscl9iNWc0VHZPZEx4QXQzdTBIUHNBQ0NOZmctc0NkTnBpMExMbk1BMzdhR3I0R1hvM3B5UVpwVjFUaW5USzVhVlZtSElocG1hY1NiWVBOS0lmNVFGUnR5QlpnUFREdkJocFBzNzQ2Mnk0Y1hUcnZ4ZmdIdmdIZ2x5aVNnTkxmeGZtMVNqZTlQZ2tia3l3RXA1RExzMjNQXzEtbHpOUWNTOFVPZmhmekZtUVNsdllwM2ViUHp3UG5DRVhXTGZZa00wandGRlVwSC16R3dHSWNKWkZKN1I4NzhfU1NhQld3aHpUSjJSSnBTNGRuN3gxZVcwalpfMDJmcnZDWUcyZGlUcXdXbkJTZWVQOHg0MG1OemdTaEpmLUlmdlhLbGU1NncwU1R3a3Rtb1dxT2FKd2l0T0ozalBydVY0YzIyZnF5blBqVFlhRzFnaDRBWVdzQ1M5SldKNERBWTBIV0tWQ1VmalhOc2dlLUM2S3ZvdWZybHNRR2RDRkdJTjlubEN3OXpKQmFQdHJWUkN3bEZHNDFzYjJfSXNsUnVmcjNkRG5Ta3pCVk1NNU1jaWtkZzEteG9wMjBvdUJIbU11MzFCbDlhNnE1RzdERGNZOEoxejczTDh2OHRvMW9RaXR4ZHBpS1BoYWtIRHVqcndIRjNlVG1nYlZTc05SYURFWTFlYWJqN3poRjhQQUlaRXBfV185STJsdldETVJuTzQ3THMtVnlNZlBKXzVWVjJxQ09YOVY4bUhRUUN1eTZHVHJ6cTJqZnZuWEMyWmk2V2xiY3BaU0MyN29pQzh2Z1dnUjhDNDFxYTZCN1FaZDJvMUFfUVVvcFpvTWdNRGJFTTZhTVlJSzBqdFJiSmIzUGlnZzU2VXFYZTJhUjFBYVpFekJOMHZuVmlBRnk3R08zTWNVZXJtQzhBY0lhSVVvcjZZbDdzbkczc3hyQlZmLTR2eWp0aS15aWdxODltaVRoblVlazM4VHFtZHV3TXdPdDJnMkJuZ2U5ZXlNZEhQTFIwOFBsVkRwdFlEWVNvMTR5VHlWZ1hMTnNsQ2JmSzcyb2xFMUVfTEZkTy1uZHFYQnp0SnhYMEZwc0pnc1FwTzhkZTZEem5WYk4wbXZrYVNnTkF0ZzNzNWZ2WlBGZnp0WHN1VVlyUWFSa2lsVTJfRjFDMlRDaUVqSWdTXzhmSm03S3ZFZHRNUjJDZ0hMYXBXLUFWQnZqYUxLVURfdlB4UjNHUk9FX1E1eDZjQmZlUEN2N05DR3hoZjZJOHJvaTI1TUJDUTdEVlluNVlkY3JDOXZCTGtzTzBNaVBYSlJTSGJtXzF4Wk9ISFg2OS1zdS1EYnFRb0V4X0tmRExORlI0MG1Qck5KOGlranY4Q1YxOXdXM1M5b0NPSk9IdkpuUlY1NDlLUXY2VGZDem84dGItdkttZk1tVFRvQnRoRXFqWk1BMm5xempISVVwQU4wOHZwSUhZOVByNXBZQ1g5OVNVNDZLS2xNSWhVZXk3aHZBZnlGelJveFJwU3ZFV0pyTnBZVjJGQXFUVkd5Sm5YYm56WGNvbHBKdDVyYU05WmFwOGJDaVJLN20zNS1HRmJCZUNoRXZJajFJWUZCeThleVBFclhwU2ViNXVuclh5cHFSVndyMVRnSDM3ZGJTVHRWVm9EUGYtTE9DMW1VX3dXQVFBbVQ3OGVCMzBoa29pb2ZBT05hV0RTZDRHc0JEVVpqejdaeUhmdHFNTXJraXNWQVhiamZVYktETjVQeVMxRjNpcFdLamZ0NGxHckIyOTB2amZ0VEc1V1lvRWdwcksxeWtwYWZ3NXYyc3BRallZWEFxTERjNndESmI4QkhJc25OZWZrbFBpSWlibnBoalVhLVM0djgybzBwQXpjc2Z0cFRlVkNzblRWaTZFRnV0cjVlMnQ5SktaT2VXUHZUUlk0ak1NRnd5M3VQeHc1UzkwWlpmUWppQlEyOEI1dERueHlaQVZsMlpXWFlHVUVQMENtV2ZDNV9SdnEtRkVhemVCbUxEeXd1MzRQamRLWjhLSS0xMnh5OWR6Q0ZsUERXLWN4c2RaeUpEVXllNzEzcGl5UGdHSUdSZ0UtZE81c01zQmVvdzladGRQazlRYzZEVXI4dmdneXZvcmwyRlVSc3pyOD0=) # <-- Put your encrypted google-services.json here
        track: internal
  react-native-ios:
    name: React Native iOS
    max_build_duration: 20
    instance_type: mac_mini
    environment:
      vars:
        XCODE_WORKSPACE: 'KmSample.xcworkspace'
        XCODE_SCHEME: 'KmSample'

        APP_STORE_CONNECT_ISSUER_ID: Encrypted(Z0FBQUFBQmdQal83TEpzOGoxRVFObFJoRjIybWxuQWNWT1ozUUxZZ1Z5ZG9jc0ZDZGNfcHM0RHIwWTYycHVvZ0ROVmk1X1lIS2N6X01KMkZVdjNVb3J3YTUxR01UTUlfcWJzSldNN1JqajBCY3htZjItb3lmTmhKcndNUXplb0M4cVV0ZmIxWkEwa1c=)
        APP_STORE_CONNECT_KEY_IDENTIFIER: Encrypted(Z0FBQUFBQmdQa0FXaFJsNHJva0xaWm9kS2Ywd1dVajdQTnl6ODYtSm55WnhEcUtYQl81amV4bUp5M1BjanFWSDNyTDd2cHJJeENhMFF1dEtwNXY2OEFsQTVQbUNYVzVhR1E9PQ==)
        APP_STORE_CONNECT_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdQanJiRkR5eGdEeEpDVUY3UC02NC1lSWJhRFRVZ1ZRS2V3WkQ5MGFRaDBURzUwMXBvNkFYYmgzNjd2aVZQYlNnR0xkNzM0VVZJQllTOTQtM0lyd0pJTEdDaXhwMXhDYWlHNjJzY1V5VVlPNkRBWFRTcDU4TV90WXZWM2dCdDRKMFdNNmhscllSazJ2cHJrQlhOWEkydml0UmI0MWZZNEZINVJ0aDdsRWEyV3NwZUpxeUp6WTVJWDQtWlgyR1VxS1dRczVzbEtTRGhsVlkyUHM1bHZmbEMzSmVQNjEtQ0FGbXh6NDFXUDAyMkVndkt1ODZkUkFwNml3M1JWdHNlZlk5WktXcUIyVkFMN0VHZU9ZeGRhYXhUVUZFWXlzVkJiQjRyc05yU0hHRi1mWllCamlOYVpHTzE1X2dYVzhNNzhnbVlxNGgyZXV0d3BHSWNnbGFiTFNUQXpMQjRZNjRrZVlyVWNJczI3c0tNV2hsbmVzcjI3R1haWnE2emhQTFlsTkVXaS1nSHIwOFlrNVhjdlJnd1dhUGFYeHJIajB5RDJzNkh5X3c3Q2tHTlJ2MDM5bz0=)
        CERTIFICATE_PRIVATE_KEY: Encrypted(Z0FBQUFBQmdQanE0SHJnNHdwQTdIclUxdW9tOWUxT2w4UlhtZVZhVmVLdkszam5JNU9vdXJDYkVfVVJmRzBEZVpvd0hnY0VkMEoxemRhZVJGUDdJR1VMZzdCQmhqT001by1NWnlLNmVPTk9Zby1MOTl4NDBURko1YmtMQ1oxN0hCRGI2aktXV0VQM1dpMWNzbmZURll1RGtmUDFkbjlrWjJidmxiWXk0LUJXRWtPYlVhX2IzcUFXMHR6c21waWZGRkhHTk5ENklHS215dGlhakRKekM5bjZHWUdBWHNWZXhlMWd0Z0IwVFdnQmdxdzBoQjdFVndsdjJFRmY4S1lRV2RXYkdzM3RkdW5EWHpySk1yR2ZaN09Ednl6dEp5aXVzUlVHdGQ3dlUzSWdFMXhVY2ZOT2ZfVnF0MVd0cVVvNVh5a29FWVRHb3Q2QVFpOFZlaE1TNFlKVllSZEFZU3FfZ1RENGRsZ18xOUtobWI1RTFjaDFRdy15MGV0QnFmRG9NWnJyM2lLdm9oMTZoekNTSEo0ZVRRdHBlOEdWXzI3cGpIbTlKdmhEaFBqbmdaZTRLSXpxZW5SdHZvWl9kdWdqNVktQmI0SWprT01BX1BiWlY4Rk9nX1BLSTJsb0p5OFR3akIwNl8zY1dwNlFBWHpkVUU5YUV3cE1oWmx5aE1Qc0NVdklmcFhCSGNBdEt6a2VfTTNHNUMxbDdpalBPVEw0eDV2WENReDRSZUhGcVVZcElla25rbTBBQWlSNnZwRlpRekE3cWl2OUF6OVJvUWY0am9tbWRKdGZ6anpzQWNRQlhSNXptSUJRcHh4aEdMUFBmY1dFRlJxYk1ra1ljMUl0Rm5xN1dZR1IyTGdOUnhEZmxqazFQNTdHZ3lKTmFreEFNQm13Ny1oT2tuMHQxWGY3a0IzOTVpeWJKaUpBRjJ3NXZrVHlRMUhtMTdqc1B3ZDFnRzhTdVdFM2FSTEE3MEhXc3VSemFZcjVfS1NkWWdCMFZRX2pTc0RaOXJyY1FtamEwWWNEY0FXWVN6Q2h0aTdSdlpEcFdhM2pNd3NUTHZBU2NMaXUxMXRNSW1XSGV6M19pSlphRXJXWmc3Q05UMlRZS1V1cHg1cFRBdENaLXFtMDVTVXphcWtOdXhxb1NGMTR3TklaTG9yZHlmWS00U1dNTlRDM2JoT1cxQ28zRmY5UGdtVmlaeE1hWFNzVVpjbGttVVZDc1hfYl9weE9JZjItbG9DNW0yVjBJY3FnQkJhNFJLYTRoUWh5Tl9KS0s5TUVUWHcyQ2lBR0tlNS1sUGZWTi05RElBQ2lINWYzdFVLY1FTU0tBanhBdXhxb0QzdVd2UElmSV9QYzlxczdPbGxoRzJReHgzaGJRZVR2d0VzNXFuM3VWR2FEaXJ1NlVGbGw5NDJGRkI1a3RtYXJWSlFic2JvUHFNLS1pOGMzOFVZZENoUGZuOW9GdHk1Q29GYlBOczVrV19KN05PcmJ6R3FXU0c4SmZYRkdoTnVvSmZEYnRDOU5sdWdnSDdIMDVBRGZIZ0RzRWhDY0w2c0FMQXFfU0Ftd2oxQXpmaGI2YlM1RUFadUVUdk55Y1ZhaU5FWFZkTGdvRnBoQU52djV5Y0tpT3VQUnZQVjl2RjhCZkhvM0pob1RrLXg4aEZqamszM2I3S3EwdXRSU0hVanB4WHNFeHBhVUkzN2haTHVJeHk0WTJ0VWJrNWlmOEgtMXgzb3ZyWVk2VVhySTJSckx3VFEwcWlUd1pTTzJzeVMzak55WXZfTVZNQ0d4X2M3QnllNC1BNGpxcGdaU01BZGliQkZBcHZDNldud1BsTEFya3AyeHN3M1pDa0dfR2hQbE1wYVdXSVhfRGduMFc4UGFIR3BKQjVCeklEUWh1RUttNFBpa05uMVVPNm9zd1Y1aXZERjhuc0k3MkVueWY5VkdTRjdMWVlqakNlWUVGVU1OYzhheUZfRVlickxqVEhfdHFFWkFoUjhvcFY0LTBxTEpXcmZxTWlmVHN2Y1VIQlJQUGMyVGxpMzdoRDhVLVRJRGRzYWNiT25hTThYM3dMY1RNaW5BLW9BUzlvajRGOW9DQ3ZWR0dVMUZCY3FyVmFHRmlUQWJtZlg4eEFtdFpCUTE4cDlld3ZScWZfeHZqSUVuaDB5TEpXdWxWcmZVYk9WZ1cyMG94dG9uNENuTnFZS1U5UGE3VlZISHpSbHNVM1Ntb1FVS25YVWc2MUJ0Z3pmWVUtTlphSFdzZGcxbFRLYV9iT2l4a3BhZExyOEREMnlOOGE4RWhjREw4M1lrWkJ3c0tXTkJUUUlpcDJId1hwajVvdjV5eTRqT1BreG1Hb3poSUtSblhjbUQyREFBMTFnWFA5MHVTTENVVkxvN1Rta2ltbnNMZjBKajAtcVFDakEtREFua1lnQlV0ZE1LSjJyX2NWSGFqcEFsYWd4UDhjV2lwaGFBaHhwdG1tdlI2eVlXTFNTc1JVdTRBNTFZeW1HejZzVkFlNkotSE5xaTlyUTQ5VlpqZktUUEJlT0lkX2djUDR6VXdMMHRkVzBRNF9YWUt2ejRyT1lMYzVtMHhJdHRpNC1oQ0Z0OXg5RHlyaUhadWgwNXpLV3NTN1AyVWJFWWExV1pJZ1pWWW5vMDBJUnp2czM2djJWZl9WNHdUbVk5UHU0Q3RieXVfVUM3WVpRaU5NZ2Y2NGZxM3gtZDFwOVBHTXFnN0E1dnFmYlFwa2RJRWpFdGx6TVdvRGo3clVCQ1E4VDZHYUxGaUVYV2hmN3l4U3AxNzZNVHlSLXRzVlFwVUVUNFBZRVFQa2FSUXpnRHJnTndXenh1NE5qZW5UM202ZkdlemNUMUNBTFJJcG1rbkx1ajVicmM4bGRzbnd6cUdZRHBUVGpLcFNxZnR2VUd0UGVSNy0yZkNHUGU2eGFvSk1OQ3pQNmdHMjA3NXVsUlFaSkZ3R2h2MFVnUXUtRFhSTTl0bHRuYWlmQXJLQm1kclNzRjlLYVBOdGVnUGEyYXpIZVZrVlNydk91M2hqbk54clJvNC05Z2RmbW8wUWY4SWdXT0t5dlFuOE9mVWNhRmVtcDJHYVhwYWxkYjZDWlZC)
      node: latest
      xcode: latest
      cocoapods: default
    triggering:
      events:
        - push
      branch_patterns:
        - pattern: master
          include: true
          source: true
    scripts:
      - name: Install npm dependencies
        script: |
          npm install
      - name: Install CocoaPods dependencies
        script: |
          cd ios && pod install
      - name: Set up keychain to be used for codesigning using Codemagic CLI 'keychain' command
        script: |
          keychain initialize
      - name:
        script: |
          # For information about Codemagic CLI commands visit: https://github.com/codemagic-ci-cd/cli-tools/blob/master/docs/app-store-connect/README.md
          echo $APP_STORE_CONNECT_ISSUER_ID
          echo $APP_STORE_CONNECT_KEY_IDENTIFIER
          echo $APP_STORE_CONNECT_PRIVATE_KEY
          echo $CERTIFICATE_PRIVATE_KEY
          app-store-connect fetch-signing-files "com.amble43.test" --type IOS_APP_DEVELOPMENT --create
      - name: Use system default keychain
        script: |
          keychain add-certificates
      - name: Increment build number
        script: |
          #!/bin/sh
          set -e
          set -x
          cd $FCI_BUILD_DIR/ios
          agvtool new-version -all $(($BUILD_NUMBER + 1))
      - name: Set up code signing settings on Xcode project
        script: |
          xcode-project use-profiles
      - name: Build ipa for distribution
        script: |
          xcode-project build-ipa --workspace "$FCI_BUILD_DIR/ios/$XCODE_WORKSPACE" --scheme "$XCODE_SCHEME"
    artifacts:
      - build/ios/ipa/*.ipa
      - /tmp/xcodebuild_logs/*.log
      - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.app
      - $HOME/Library/Developer/Xcode/DerivedData/**/Build/**/*.dSYM
    publishing:
      email:
        recipients:
          - micah.price@cortexlogic.com
        notify:
          success: true
          failure: false
      app_store_connect:
        apple_id: Encrypted(Z0FBQUFBQmdQSl9nRnladFhTYjVkcWVTcXJZTGhoclZwRWdZRFBoVGJvVmtXSjZmdW1PYUhnRmVvMURxUjZjNmNVdU5pekh5MC1MUTZ2TmxTcFlLeWNCcEl2MTJWanlwaTlRSlYzUC1WOWljdVBGRWxRUXlRc2c9)
        password: Encrypted(Z0FBQUFBQmdQSl9DM0FES01ZR1FHc09sanA0dXNtX3pScHRiY1NBNzVrLUh1c2xRSXRhbHF3MUxhWklTSGdKNTQtQWxWdmRTTTAzaWFVZDF1M3F4b1NOR0RHN1VVNEh5eFVkODZkc1pLY3B5RTdMSlc0NTRoMGs9)
